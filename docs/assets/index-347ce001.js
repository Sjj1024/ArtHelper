import{d as e,u as a,o as t,r as s,j as r,B as o,m as i,h as n}from"./index-efa3a32c.js";import{F as m}from"./index-ae2d5997.js";import{a as d}from"./index-639ffc53.js";import"./index-0373e759.js";/* empty css              */import{I as l}from"./index-8c8b720f.js";import"./index-9b480cfe.js";import"./index-9b8a3313.js";import{a as c}from"./v1api-f78cc73a.js";import{u}from"./useSetState-78ffd672.js";import{M as p}from"./index-46e73bcd.js";import"./context-cb88fb1e.js";import"./responsiveObserve-b13564d4.js";import"./pickAttrs-1cd23dfa.js";import"./index-40784afc.js";import"./getScrollBarSize-c6833c2b.js";import"./index-1c1deade.js";import"./statusUtils-b010cbea.js";import"./CheckOutlined-f0d55485.js";import"./SearchOutlined-03c63d28.js";import"./isEqual-8ee5b3ce.js";import"./useForceUpdate-9ad39bdf.js";import"./index-0a1440ec.js";import"./index-177532f7.js";import"./EyeOutlined-319494bf.js";import"./ActionButton-e012fb99.js";import"./Portal-08554165.js";function j(){var j;document.title="查看积分",e((e=>e.app.powersCode));const h=a();let[x,g]=t();const f=x.get("clubId"),[y]=m.useForm(),[w,S]=s.useState([]),[k,v]=s.useState(!1),[I,b]=u({operateType:"add",nowData:null,modalShow:!1,modalLoading:!1}),C=async()=>{v(!0);try{const e=await c.viewPoints({legionuuid:f});e&&200===e.code?S(e.data):i.error((null==e?void 0:e.message)??"获取失败")}finally{v(!1)}},D=[{title:"比赛名称",dataIndex:"matchname",key:"matchname"},{title:"所属联赛",dataIndex:"leaguename",key:"leaguename"},{title:"积分",dataIndex:"currentscore",key:"currentscore"},{title:"比赛时间",dataIndex:"matchstart",key:"matchstart",render:e=>n(e).format("YYYY-MM-DD HH:mm:ss")},{title:"操作",key:"control",render:(e,a)=>r.jsx("span",{style:{color:"rgb( 66,149,229)",cursor:"pointer"},onClick:()=>{b({modalShow:!0,nowData:a}),y.setFieldsValue({matchname:a.matchname,currentscore:a.currentscore})},children:"编辑积分"})}],L=s.useMemo((()=>w.map((e=>({key:e.legionuuid,id:e.id,leaguename:e.leaguename,currentscore:e.currentscore,matchstart:e.matchstart,matchname:e.matchname,matchuuid:e.matchuuid,status:e.status})))),[w]);return s.useEffect((()=>{C()}),[]),r.jsxs("div",{className:"SignupBox",children:[r.jsxs("div",{className:"actionBox",children:[r.jsx("h2",{children:"查看积分"}),r.jsx(o,{onClick:()=>{h(-1)},children:"返回"})]}),r.jsx(d,{columns:D,loading:k,dataSource:L,rowKey:e=>e.key}),r.jsx(p,{title:"编辑积分",open:I.modalShow,onCancel:()=>b({modalShow:!1}),onOk:()=>(async e=>{var a;b({modalLoading:!0});const t={currentscore:parseInt(e.currentscore),id:null==(a=I.nowData)?void 0:a.id};try{const e=await c.editPoints(t);e&&200===e.code?(i.success("编辑成功"),b({modalShow:!1,modalLoading:!1}),C()):i.error((null==e?void 0:e.message)??"编辑失败")}catch(s){i.error("编辑失败，请重试")}finally{b({modalLoading:!1})}})(y.getFieldsValue()),confirmLoading:I.modalLoading,children:r.jsxs(m,{form:y,labelCol:{span:6},children:[r.jsx(m.Item,{label:"比赛名称",name:"matchname",rules:[{required:!0,message:"请输入比赛名称"}],children:r.jsx("span",{children:null==(j=I.nowData)?void 0:j.matchname})}),r.jsx(m.Item,{label:"比赛积分",name:"currentscore",rules:[{required:!0,message:"请输入比赛积分"},{pattern:/^[0-9]*$/,message:"请输入正确的积分"},{min:0,max:999,message:"积分必须在0到999之间"}],children:r.jsx(l,{placeholder:"请输入积分"})})]})})]})}export{j as default};
