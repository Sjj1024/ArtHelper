import{o as e,u as i,r as l,j as a,S as t,B as s,h as n,m as o}from"./index-efa3a32c.js";import{C as r}from"./index-b686cec5.js";import{C as m}from"./index-0373e759.js";import{F as d}from"./index-ae2d5997.js";import{I as u}from"./index-8c8b720f.js";import{I as c}from"./index-06b8a89d.js";/* empty css              */import{T as p}from"./index-bf31a83e.js";import"./index-1acfbbfd.js";import"./index-47693ae2.js";import{u as j}from"./user-66ba9e41.js";import{s as x}from"./store-7211fed8.js";import{S as v}from"./index-1c1deade.js";import{C as f}from"./CloseOutlined-77969fe0.js";import"./index-0a1440ec.js";import"./context-cb88fb1e.js";import"./responsiveObserve-b13564d4.js";import"./index-177532f7.js";import"./statusUtils-b010cbea.js";import"./EyeOutlined-319494bf.js";import"./SearchOutlined-03c63d28.js";import"./CalendarOutlined-8ff6678f.js";import"./pickAttrs-1cd23dfa.js";import"./CheckOutlined-f0d55485.js";function h(){let[h,b]=e();const C=h.get("field"),y=i();document.title="add"===C?"新增场地":"编辑场地";const[g]=d.useForm(),[w,H]=l.useState([]),[k,I]=l.useState([]),T=async e=>{const i=(await j.getStores({agenuuid:e})).data.map((e=>({label:e.providername,value:e.uuid})));I(i)},N=[{label:"周一",value:"mon"},{label:"周二",value:"tue"},{label:"周三",value:"wed"},{label:"周四",value:"thu"},{label:"周五",value:"fri"},{label:"周六",value:"sat"},{label:"周日",value:"sun"}],F=()=>{};l.useEffect((()=>{(async()=>{const e=(await j.getAgents()).data.map((e=>({label:e.providername,value:e.uuid})));H(e)})(),(async()=>{var e,i,l,a,t,s,r,m;const d=await x.fileDetail({uuid:C});if(d&&200===d.code){const o=null==d?void 0:d.data,u=(null==(e=null==o?void 0:o.stationintro)?void 0:e.start_time)?n(null==(i=null==o?void 0:o.stationintro)?void 0:i.start_time,"HH:mm"):"",c=(null==(l=null==o?void 0:o.stationintro)?void 0:l.end_time)?n(null==(a=null==o?void 0:o.stationintro)?void 0:a.end_time,"HH:mm"):"";await T(null==(t=null==o?void 0:o.agentinfor)?void 0:t.uuid);const p={proxy:null==(s=null==o?void 0:o.agentinfor)?void 0:s.uuid,store:null==(r=null==o?void 0:o.provider)?void 0:r.uuid,fileName:null==o?void 0:o.stationname,fileTime:[u,c],limit:null==(m=null==o?void 0:o.stationintro)?void 0:m.maxpeople};g.setFieldsValue(p)}else o.error((null==d?void 0:d.msg)??"获取失败")})()}),[]);return a.jsx("div",{className:"field-edit-box",children:a.jsxs(d,{labelCol:{span:4},wrapperCol:{span:16},form:g,name:"control-hooks",onFinish:e=>{},style:{maxWidth:600},children:[a.jsx(d.Item,{name:"proxy",label:"所属代理",rules:[{required:!0}],children:a.jsx(v,{placeholder:"请选择代理",allowClear:!0,onChange:T,options:w})}),a.jsx(d.Item,{name:"store",label:"所属门店",rules:[{required:!0}],children:a.jsx(v,{placeholder:"请选择门店",onChange:e=>{},options:k,allowClear:!0})}),a.jsx(d.Item,{name:"fileName",label:"场地名称",rules:[{required:!0,max:12}],children:a.jsx(u,{})}),a.jsx(d.Item,{name:"fileTime",label:"运营时间",children:a.jsx(p.RangePicker,{format:"HH:mm"})}),a.jsx(d.Item,{name:"limit",label:"人数限制",children:a.jsx(c,{min:0,max:99})}),a.jsx(d.List,{name:"items",children:(e=[],{add:i,remove:l})=>a.jsx("div",{style:{display:"flex",rowGap:16,flexDirection:"column",justifyContent:"center"},children:e.map(((e,i)=>a.jsxs(r,{size:"small",title:`价格规则${e.name+1}`,extra:a.jsx(f,{onClick:()=>{l(e.name)}}),children:[a.jsx(d.Item,{label:"整场价格",name:[e.name,"allPrice"],children:a.jsx(u,{})}),a.jsx(d.Item,{label:"散客价格",name:[e.name,"customPrice"],children:a.jsx(u,{})}),a.jsx(d.Item,{label:"价格时间",name:[e.name,"priceTime"],children:a.jsx(p.RangePicker,{format:"HH:mm"})}),a.jsx("div",{className:"week",children:a.jsx(m.Group,{options:N,onChange:F})})]},e.key)))})},1),a.jsxs(t,{className:"bottom-btn",children:[a.jsx(s,{type:"primary",className:"submit",onClick:async()=>{try{const e=await g.validateFields(),i={uuid:C,provideruuid:e.store,stationname:e.fileName,start_time:e.fileTime?n(e.fileTime[0]).format("HH:mm"):"",end_time:e.fileTime?n(e.fileTime[1]).format("HH:mm"):"",maxpeople:e.limit},l=await x.editPlay(i);l&&200===l.code?(o.success("编辑成功"),y("/store/field")):o.error((null==l?void 0:l.message)??"操作失败")}catch(e){}},children:"提交"}),a.jsx(s,{htmlType:"button",onClick:()=>{y(-1)},children:"返回"})]})]})})}export{h as default};
