import{u as e,r as t,o as r,j as i,B as s,m as n}from"./index-efa3a32c.js";import{F as o}from"./index-ae2d5997.js";import{I as a}from"./index-8c8b720f.js";import{o as l}from"./order-4f5746de.js";import{u as d}from"./useSetState-78ffd672.js";import{M as c}from"./index-46e73bcd.js";import"./context-cb88fb1e.js";import"./responsiveObserve-b13564d4.js";import"./index-177532f7.js";import"./statusUtils-b010cbea.js";import"./EyeOutlined-319494bf.js";import"./SearchOutlined-03c63d28.js";import"./ActionButton-e012fb99.js";import"./Portal-08554165.js";import"./getScrollBarSize-c6833c2b.js";import"./pickAttrs-1cd23dfa.js";const m=()=>{document.title="场地管理",e();const[m,p]=t.useState([]);let[x,u]=r();const h=x.get("field"),j=x.get("men"),g=x.get("dai"),[y,f]=t.useState(!1),[w,S]=t.useState(!1),[k,v]=t.useState([]),[K,b]=t.useState(),[A,C]=t.useState("");t.useEffect((()=>{C(JSON.stringify(m))}),[m]);const O=(e,t)=>{const r=k.some((r=>r.rowKey===t&&r.columnKey===e.week)),i=e.weekarr[t].explain;return r?"rgb(161, 211, 254)":0!=i?"rgb(162, 225, 248)":"rgb(234, 234, 234)"},[$,B]=t.useState(!1),E=e=>`星期${["","一","二","三","四","五","六","日"][e]}`,F=new Date,I=F.getFullYear(),P=F.getMonth()+1,D=F.getDate(),[M,N]=d({time:I+"-"+(P<10?"0"+P:P)+"-"+(D<10?"0"+D:D),coachuuid:h});return t.useEffect((()=>{(async()=>{const e={stationuuid:h};f(!0);try{const t=await l.stationPrice(e);t&&200===t.code?p(t.data):n.error((null==t?void 0:t.message)??"获取失败")}finally{f(!1)}})()}),[M]),i.jsx(i.Fragment,{children:i.jsxs("div",{children:[i.jsx("div",{style:{height:"30px"},children:w&&i.jsx(s,{type:"primary",onClick:()=>{B(!0)},children:"设置价格"})}),i.jsx("div",{children:i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{width:"60px"}}),m.map(((e,t)=>i.jsxs("th",{style:{width:"200px"},children:[i.jsx("div",{children:E(e.week)}),i.jsx("div",{children:e.time})]},t)))]})}),i.jsx("tbody",{children:Array.from({length:24},((e,t)=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:"60px",height:"60px"},children:i.jsx("div",{style:{marginTop:"-30px",textAlign:"right",paddingRight:"8px"},children:` ${t.toString().padStart(2,"0")}:00`})}),m.map(((e,r)=>i.jsx("td",{style:{backgroundColor:O(e,t),textAlign:"center",border:"1px solid #fff",padding:"20px 0"},id:`cell-${t}-${e.week}`,onClick:()=>((e,t)=>{const r={rowKey:t,columnKey:e.week},i=k.findIndex((e=>e.rowKey===r.rowKey&&e.columnKey===r.columnKey));-1===i?(S(!0),v([...k,r])):v(k.filter(((e,t)=>t!==i)))})(e,t),children:0==e.weekarr[t].explain?"无服务":e.weekarr[t].explain},r)))]},t)))})]})}),i.jsx(c,{open:$,onOk:async()=>{B(!1);const e={provideruuid:g,storeuuid:j,stationuuid:h,pricedata:A};f(!0);try{const t=await l.setStationPrice(e);t&&200===t.code?(p(t.data),window.location.reload()):n.error((null==t?void 0:t.message)??"获取失败")}finally{f(!1)}},onCancel:()=>{B(!1)},title:"设置价格",children:i.jsx(o,{className:"price-form",children:i.jsx(o.Item,{label:"价格",children:i.jsx(a,{style:{width:100},value:K,onChange:e=>{if(b(e.target.value),k.length>0){const t=m.map((t=>({...t,weekarr:t.weekarr.map(((r,i)=>{const s=i;return k.some((e=>e.rowKey===s&&e.columnKey===t.week))?{...r,explain:e.target.value}:r}))})));p(t)}},placeholder:"请输入价格"})})})})]})})};export{m as default};
