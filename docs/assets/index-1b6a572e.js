import{d as e,u as i,o as t,r as o,j as s,B as a,m as r,h as n}from"./index-efa3a32c.js";import{F as d}from"./index-ae2d5997.js";import{a as l}from"./index-639ffc53.js";import"./index-0373e759.js";/* empty css              */import{I as m}from"./index-8c8b720f.js";import"./index-9b480cfe.js";import"./index-9b8a3313.js";import{P as c}from"./index-94ed3db3.js";import{a as p}from"./v1api-f78cc73a.js";import{u}from"./useSetState-78ffd672.js";import{M as j}from"./index-46e73bcd.js";import"./context-cb88fb1e.js";import"./responsiveObserve-b13564d4.js";import"./pickAttrs-1cd23dfa.js";import"./index-40784afc.js";import"./getScrollBarSize-c6833c2b.js";import"./index-1c1deade.js";import"./statusUtils-b010cbea.js";import"./CheckOutlined-f0d55485.js";import"./SearchOutlined-03c63d28.js";import"./isEqual-8ee5b3ce.js";import"./useForceUpdate-9ad39bdf.js";import"./index-0a1440ec.js";import"./index-177532f7.js";import"./EyeOutlined-319494bf.js";import"./ActionButton-e012fb99.js";import"./Portal-08554165.js";function x(){document.title="报名管理",e((e=>e.app.powersCode));const x=i();let[h,g]=t();const y=h.get("matchuuid"),[f]=d.useForm(),[k,S]=o.useState([]),[w,v]=o.useState(!1),[I,D]=u({operateType:"add",nowData:null,modalShow:!1,modalLoading:!1}),C=async()=>{v(!0);try{const e=await p.matchSignList({matchuuid:y});e&&200===e.code?S(e.data):r.error((null==e?void 0:e.message)??"获取失败")}finally{v(!1)}},b=[{title:"俱乐部ID",dataIndex:"id",key:"id"},{title:"俱乐部名称",dataIndex:"legionname",key:"legionname"},{title:"当前比赛积分",dataIndex:"currentscore",key:"currentscore"},{title:"报名时间",dataIndex:"addtime",key:"addtime",render:e=>n(e).format("YYYY-MM-DD HH:mm:ss")},{title:"操作",key:"control",render:(e,i)=>s.jsx(c,{title:"确定删除吗？",onConfirm:()=>(async e=>{const i={matchuuid:y,legionuuid:e.key},t=await p.delMatchSign(i);t&&200===t.code?(r.success("删除成功"),C()):r.error((null==t?void 0:t.message)??"删除失败")})(i),okText:"确定",cancelText:"取消",children:s.jsx("span",{style:{color:"red",cursor:"pointer"},children:"删除"})})}],B=o.useMemo((()=>k.map((e=>({key:e.legionuuid,id:e.id,legionid:e.legionid,legionname:e.legionname,currentscore:e.currentscore,addtime:e.addtime})))),[k]);return o.useEffect((()=>{C()}),[]),s.jsxs("div",{className:"SignupBox",children:[s.jsxs("div",{className:"actionBox",children:[s.jsx("h2",{style:{fontWeight:"bold"},children:"查看报名"}),s.jsxs("div",{className:"buttonBox",children:[s.jsx(a,{type:"primary",onClick:()=>{D({operateType:"add",nowData:null,modalShow:!0})},children:"添加俱乐部"}),s.jsx(a,{type:"primary",onClick:()=>(async()=>{const e=document.createElement("a");e.href=`https://dev.hado-official.cn/v1/crm_api_com/export_club_list?matchuuid=${y}`,e.click()})(),children:"导出"}),s.jsx(a,{onClick:()=>{x(-1)},children:"返回"})]})]}),s.jsx(l,{columns:b,loading:w,dataSource:B,rowKey:e=>e.key}),s.jsx(j,{title:"新建报名",open:I.modalShow,onCancel:()=>D({modalShow:!1}),onOk:()=>(async()=>{try{const e=await f.validateFields(),i={matchuuid:y,legionid:Number(e.legionid)},t=await p.addMatchSign(i);t&&200===t.code?(r.success("新建报名成功"),D({modalShow:!1}),C()):r.error((null==t?void 0:t.message)??"新建报名失败")}catch(e){}})(f.getFieldsValue()),confirmLoading:I.modalLoading,children:s.jsx(d,{form:f,labelCol:{span:6},children:s.jsx(d.Item,{label:"俱乐部ID",name:"legionid",rules:[{required:!0,message:"请输入俱乐部ID"},{pattern:/^[0-9]*$/,message:"请输入正确的俱乐部ID"}],children:s.jsx(m,{placeholder:"请输入俱乐部ID"})})})})]})}export{x as default};
