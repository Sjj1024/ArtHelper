import{r as e,A as t,_ as a,u as s,d as r,j as i,B as o,m as c,T as n}from"./index-efa3a32c.js";import{F as l}from"./index-ae2d5997.js";import{I as d}from"./index-8c8b720f.js";import{a as m}from"./index-639ffc53.js";import"./index-0373e759.js";/* empty css              */import"./index-9b480cfe.js";import"./index-9b8a3313.js";import{P as u}from"./index-94ed3db3.js";import{D as p}from"./index-65748fb5.js";import{I as h}from"./index-06b8a89d.js";import{u as x}from"./user-66ba9e41.js";import{s as j}from"./store-7211fed8.js";import{t as g}from"./teacher-ae538df4.js";import{u as f}from"./useSetState-78ffd672.js";import{M as v}from"./index-46e73bcd.js";import{S as y}from"./index-1c1deade.js";import{C as S}from"./CalendarOutlined-8ff6678f.js";import{P as w}from"./PlusCircleOutlined-176a31dc.js";import{E as b}from"./EditOutlined-e081177a.js";import{D as k}from"./DisconnectOutlined-510bc31e.js";import{C as T}from"./CheckOutlined-4f8ce362.js";import"./context-cb88fb1e.js";import"./responsiveObserve-b13564d4.js";import"./index-177532f7.js";import"./statusUtils-b010cbea.js";import"./EyeOutlined-319494bf.js";import"./SearchOutlined-03c63d28.js";import"./pickAttrs-1cd23dfa.js";import"./index-40784afc.js";import"./getScrollBarSize-c6833c2b.js";import"./isEqual-8ee5b3ce.js";import"./useForceUpdate-9ad39bdf.js";import"./index-0a1440ec.js";import"./ActionButton-e012fb99.js";import"./Portal-08554165.js";import"./CheckOutlined-f0d55485.js";var I=function(s,r){return e.createElement(t,a({},s,{ref:r,icon:S}))};const N=e.forwardRef(I);const C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M594.3 601.5a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1 8 8 0 008 8.4H407c4.2 0 7.6-3.3 7.9-7.5 3.8-50.6 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H661a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.7-126.1zM512 578c-28.5 0-51.7-23.3-51.7-52s23.2-52 51.7-52 51.7 23.3 51.7 52-23.2 52-51.7 52zm416-354H768v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H548v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H328v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H96c-17.7 0-32 14.3-32 32v576c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V256c0-17.7-14.3-32-32-32zm-40 568H136V296h120v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h120v496z"}}]},name:"contacts",theme:"outlined"};var z=function(s,r){return e.createElement(t,a({},s,{ref:r,icon:C}))};const P=e.forwardRef(z),{TextArea:O}=d,E={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:19}}};function H(){document.title="教练列表";const t=s(),a=r((e=>e.app.powersCode)),[S]=l.useForm(),[I,C]=e.useState([]),[z,H]=e.useState(!1),[D,$]=f({pageNum:1,pageSize:10,total:0}),[q,A]=f({operateType:"add",nowData:null,modalShow:!1,modalLoading:!1}),F=(e,a)=>{t("add"===a?"/store/teacher/add":"up"===a?`/store/teacher/edit?teacher=${null==e?void 0:e.uuid}`:"calendar"===a?`/store/teacher/work?teacher=${null==e?void 0:e.uuid}`:"leave"===a?`/store/teacher/leave?teacher=${null==e?void 0:e.uuid}`:`/store/detail?teacher=${null==e?void 0:e.uuid}`)},B=(S.validateFields(),async e=>{if(!a.includes("teacher:list"))return;const t={page:e.pageNum,limit:e.pageSize};H(!0);try{const a=await g.getTeacherList(t);a&&200===a.code?(C(a.data),$({total:a.cont,pageNum:e.pageNum,pageSize:e.pageSize})):c.error((null==a?void 0:a.message)??"获取失败")}finally{H(!1)}}),[L,M]=f(),[R,V]=e.useState([]),[U,G]=e.useState([]);const J=[{title:"编号",dataIndex:"serial",key:"serial"},{title:"教练名称",dataIndex:"teacherName",key:"teacherName"},{title:"所属门店",dataIndex:"store",key:"store"},{title:"所属代理",dataIndex:"storeProxy",key:"storeProxy"},{title:"教练价格",dataIndex:"teacherPrice",key:"teacherPrice"},{title:"教练介绍",dataIndex:"teacherDesc",key:"teacherDesc"},{title:"教练时间",dataIndex:"teacherTime",key:"teacherTime"},{title:"教练状态",dataIndex:"teacherStatus",key:"teacherStatus"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"control",width:200,render:(e,t)=>{const s=[];a.includes("teacher:work")&&s.push(i.jsx("span",{className:"control-btn blue",onClick:()=>F(t,"calendar"),children:i.jsx(n,{placement:"top",title:"日程",children:i.jsx(N,{})})},"1")),a.includes("teacher:leave")&&s.push(i.jsx("span",{className:"control-btn blue",onClick:()=>F(t,"leave"),children:i.jsx(n,{placement:"top",title:"假勤",children:i.jsx(P,{})})},"2")),a.includes("teacher:edit")&&s.push(i.jsx("span",{className:"control-btn blue",onClick:()=>F(t,"up"),children:i.jsx(n,{placement:"top",title:"编辑",children:i.jsx(b,{})})},"3")),a.includes("teacher:cold")&&s.push(i.jsx(u,{title:1===t.status?"确定设置为在职吗？":"确定设置为离职吗？",onConfirm:()=>(async e=>{H(!0);try{let t=await g.editTeacherStatus({coachuuid:e.uuid,status:1===e.status?0:1});t&&200===t.code?(c.success("操作成功"),B(D)):c.error((null==t?void 0:t.message)??"操作失败")}finally{H(!1)}})(t),okText:"确定",cancelText:"取消",children:i.jsx("span",{className:"control-btn red",children:i.jsx(n,{placement:"top",title:0===L?"在职":"离职",children:1===t.status?i.jsx(k,{}):i.jsx(T,{style:{color:"green"}})})})},"4"));const r=[];return s.forEach(((e,t)=>{t&&r.push(i.jsx(p,{type:"vertical"},`line${t}`)),r.push(e)})),r}}],Q=e.useMemo((()=>I.map(((e,t)=>{return{key:e.id,uuid:e.uuid,serial:t+1+(D.pageNum-1)*D.pageSize,teacherName:e.coachname,store:e.storename,storeProxy:e.providername,teacherPrice:e.coachprice,teacherDesc:e.coachintro,teacherTime:(a=e.workingday,a.split(",").map((e=>function(e){switch(e){case 1:return"周一";case 2:return"周二";case 3:return"周三";case 4:return"周四";case 5:return"周五";case 6:return"周六";case 7:return"周日";default:return}}(parseInt(e)))).join(", ")),teacherStatus:0===e.status?"在职":"离职",createTime:e.addtime,status:e.status};var a}))),[D,I]);return e.useEffect((()=>{B(D),(async()=>{await j.getStoreType()})(),(async()=>{const e=(await x.getAgents()).data.map((e=>({label:e.providername,value:e.uuid})));V(e)})()}),[]),i.jsxs("div",{className:"store-list-box",children:[i.jsx("div",{className:"g-search",children:i.jsx("ul",{className:"search-func",children:a.includes("teacher:add")&&i.jsx("li",{children:i.jsx(o,{type:"primary",icon:i.jsx(w,{}),disabled:!a.includes("teacher:add"),onClick:()=>F(null,"add"),children:"新增教练"})})})}),i.jsx("div",{className:"diy-table",children:i.jsx(m,{columns:J,loading:z,dataSource:Q,pagination:{total:D.total,current:D.pageNum,pageSize:D.pageSize,showQuickJumper:!1,showTotal:e=>`共 ${e} 条数据`,onChange:(e,t)=>((e,t)=>{B({pageNum:e,pageSize:t||D.pageSize})})(e,t)}})}),i.jsx(v,{title:{add:"新增教练",up:"编辑角色",see:"查看"}[q.operateType],open:q.modalShow,cancelText:"取消",okText:"确认",onCancel:()=>(S.setFieldsValue({rolename:"",proxy:"",store:"",desc:"",limit:""}),void A({modalShow:!1})),confirmLoading:q.modalLoading,children:i.jsxs(l,{form:S,initialValues:{formConditions:1},children:[i.jsx(l.Item,{label:"教练名称",name:"rolename",...E,rules:[{required:!0,whitespace:!0,message:"请输入教练名称"},{max:20,message:"最多输入20位字符"}],children:i.jsx(d,{placeholder:"请输入教练名",disabled:"see"===q.operateType})}),i.jsx(l.Item,{label:"所属代理",name:"proxy",...E,rules:[{required:!0,message:"请选择所属代理"}],children:i.jsx(y,{disabled:"see"===q.operateType,options:R,onSelect:async e=>{const t=(await x.getStores({agenuuid:e})).data.map((e=>({label:e.providername,value:e.uuid})));G(t)},placeholder:"请选择所属代理"})}),i.jsx(l.Item,{label:"所属门店",name:"store",...E,rules:[{required:!0,message:"请选择所属门店"}],children:i.jsx(y,{disabled:"see"===q.operateType,options:U,placeholder:"请选择所属门店"})}),i.jsx(l.Item,{label:"角色描述",name:"desc",...E,rules:[{max:200,message:"最多输入200个字符"},{required:!0,message:"请输入角色描述"}],children:i.jsx(O,{rows:4,disabled:"see"===q.operateType,autoSize:{minRows:2,maxRows:6}})}),i.jsx(l.Item,{label:"数量限制",name:"limit",...E,rules:[{required:!0,message:"请输入数量限制"}],children:i.jsx(h,{min:0,max:99,style:{width:"100%"},disabled:"see"===q.operateType})})]})})]})}export{H as default};
